#|==========================================================|#
#| circos configuration template -- autogenerated by fsnviz |#
#|==========================================================|#

# general imports
<<include etc/housekeeping.conf>>

<colors>
  <<include etc/colors.conf>>
</colors>

<fonts>
  <<include etc/fonts.conf>>
</fonts>

# global settings
chromosomes_display_default = yes
chromosomes_units           = 1000000
karyotype                   = {{ karyotype }}

# output image
<image>
  <<include etc/image.conf>>
  angle_offset*      = -90
  auto_alpha_colors* = yes
  auto_alpha_steps*  = 5
  background*        = white
  dir*               = {{ image_dir|default(".") }}
  file*              = {{ image_file }}
  png*               = {{ image_png|default("no") }}
  radius*            = 1500p
  svg*               = {{ image_png|default("yes") }}
</image>

# ideogram
<ideogram>
  thickness        = 100p
  stroke_thickness = 2
  stroke_color     = black
  fill             = yes
  fill_color       = black

  # fractional radius position of chromosome ideogram within image
  label_case     = upper
  label_font     = condensedbold
  label_parallel = yes
  label_radius   = dims(ideogram,radius) - 0.15r
  label_size     = 40p
  label_with_tag = yes
  radius         = 0.75r
  show_label     = yes

  # cytogenetic bands
  band_stroke_thickness = 2
  band_transparency     = 0
  fill_bands            = yes
  show_bands            = yes

  <spacing>
    axis_break         = yes
    axis_break_at_edge = yes
    axis_break_style   = 2
    break              = 5u
    default            = 40u

    <break_style 1>
      fill_color       = blue
      stroke_color     = black
      stroke_thickness = 2
      thickness        = 0.25r
    </break>

    <break_style 2>
      stroke_color     = black
      stroke_thickness = 3
      thickness        = 1.5r
    </break>
  </spacing>
</ideogram>

# fusion links
<links>
  bezier_radius = 0.5r
  radius        = 0.94r
  z             = 0

  <link segdup>
    file      = {{ fusion_links_file }}
    show      = yes
    color     = vvdgrey
    thickness = 8

  <rules>
    <rule>
      condition  = _SIZE1_ < 1.5kb || _SIZE2_ < 1.5kb
      importance = 110
      show       = yes
    </rule>

    # the next two rules must contain flow=continue because it 
    # always matches and you do not want it to terminate
    # the rule chain (otherwise the color rule would
    # never be checked)
    <rule>
      condition  = 1
      flow       = continue
      importance = 100
      thickness  = eval(max(1,min(6,exp(_SIZE1_/50000))))
    </rule>

    <rule>
      bezier_radius = eval( (0.5 + 0.4*(1-abs(_START1_-_START2_) / 100Mb)) . "r")
      condition     = _CHR1_ eq _CHR2_ && abs(_START1_-_START2_) < 100Mb
      flow          = continue
      importance    = 95
    </rule>

    <rule>
      color      = red
      condition  = (_CHR1_ eq "hs2" && abs(_START1_ - 100Mb) < 20Mb) || (_CHR2_ eq "hs2" && abs(_START2_ - 100Mb) < 20Mb)
      importance = 90
    </rule>
  </rules>

  </link>
</links>

# gene labels
<plots>
  <plot>
    color                          = black
    file                           = {{ gene_labels_file }}
    label_font                     = condensed
    label_rotate                   = yes
    label_size                     = 30p
    label_snuggle                  = yes
    link_color                     = grey
    link_dims                      = 4p,45p,40p,40p,10p
    link_thickness                 = 4p
    max_snuggle_distance           = 4r
    padding                        = 10p
    r0                             = 1r
    r1                             = 1r+400p
    rpadding                       = 0p
    show                           = yes
    show_links                     = yes
    snuggle_link_overlap_test      = yes
    snuggle_link_overlap_tolerance = 0p
    snuggle_refine                 = no
    snuggle_sampling               = 2
    snuggle_tolerance              = 0r
    type                           = text
  </plot>
</plots>

# ticks
show_ticks       = no
show_tick_labels = no
<ticks>
  color            = black
  label_separation = 1p
  multiplier       = 1/1u
  radius           = dims(ideogram,radius_outer)
  size             = 20p
  skip_first_label = no
  skip_last_label  = no
  thickness        = 4p
  tick_separation  = 3p

  <tick>
    color      = dgrey
    show_label = no
    spacing    = 1u
    thickness  = 2p
  </tick>

  <tick>
    color      = vdgrey
    show_label = no
    spacing    = 5u
    thickness  = 3p
  </tick>

  <tick>
    format         = %d
    grid           = yes
    grid_color     = dgrey
    grid_end       = 0.999r
    grid_start     = 0.5r
    grid_thickness = 1p
    label_offset   = 10p
    label_size     = 20p
    show_label     = yes
    spacing        = 10u
  </tick>
</ticks>

